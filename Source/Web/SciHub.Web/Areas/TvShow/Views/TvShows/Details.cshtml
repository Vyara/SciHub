@using SciHub.Web.Areas.Movie.ViewModels.Ratings
@model SciHub.Web.Areas.TvShow.ViewModels.TvShows.TvShowDetailsViewModel
@{
    ViewBag.Title = "Details";
}

<h2>@Html.ActionLink("Back To The Shows", "Index", "TvShows")</h2>

<div class="row well">
    <div class="col-lg-5">
        <img src="data:image;base64,@Convert.ToBase64String(@Model.Poster.Image)" style="width: 100%" alt="@Model.Title Poster" />
    </div>
    <div class="col-lg-7">
        <h2>@Model.Title</h2>
        @if (@Model.EndYear == null)
        {
            <p>(@Model.StartYear -  )</p>
        }

        else
        {
            <p>(@Model.StartYear - @Model.EndYear )</p>
        }
        <br />
        <h4>Directors:</h4>
        @foreach (var director in Model.Directors)
        {
            <p>@director.FullName</p>
        }

        <h4>Studio:</h4>
        @Html.ActionLink(@Model.Channel.Name, "TvShowsByChannel", "TvShows", new { id = Model.Channel.Id }, new { area = "TvShow" })
        <h4>Cast:</h4>
        @foreach (var actor in Model.Actors)
        {
            <p> @Html.ActionLink(@actor.FullName, "TvShowsByActor", "TvShows", new { id = @actor.Id }, new { area = "TvShow" })</p>
        }
        <h4>Summary:</h4>
        <p>@Model.Summary</p>

        <span class="glyphicon glyphicon-star" aria-hidden="true"></span>
        <span id="current-rating">@string.Format("{0}", Model.RatingsCount) </span>

        @if (Request.IsAuthenticated)
        {
            <div>
                @Ajax.ActionLink("Rate", "Rate", "TvShows", new { id = Model.Id },
            new AjaxOptions
            {
                UpdateTargetId = "current-rating",
                HttpMethod = "GET",
                InsertionMode = InsertionMode.Replace
            }, new { @class = "btn btn-info" })
            </div>
        }
        @if (@Model.CommentsCount == 1)
        {
            <h4>@Model.CommentsCount Comment</h4>
        }

        else
        {
            <h4>@Model.CommentsCount Comments</h4>
        }

        @foreach (var tag in Model.Tags)
        {
            <span>@Html.ActionLink("#" + @tag.Name, "TvShowsByTag", "TvShows", new { id = @tag.Id }, new { area = "TvShow" })</span>
        }
    </div>



</div>
@if (Request.IsAuthenticated)
{
    <div>
        @Ajax.ActionLink("Add a Comment", "Rate", "TvShows", new { id = Model.Id },
            new AjaxOptions
            {
                UpdateTargetId = "holder",
                HttpMethod = "GET",
                InsertionMode = InsertionMode.Replace
            }, new { @class = "btn btn-info" })
    </div>
}
@foreach (var comment in Model.Comments)
{
    <div class="row well-sm">
        <div class="well-sm">
            @comment.Content
        </div>
        <p>Posted on: @comment.CreatedOn, By: @comment.Author </p>
    </div>
}



@section scripts {
    @Scripts.Render("~/Scripts/jquery.unobtrusive-ajax.min.js")
}